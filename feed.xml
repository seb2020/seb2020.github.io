<?xml version="1.0" encoding="utf-8"?><feed xmlns="http://www.w3.org/2005/Atom" xml:lang="en"><generator uri="https://jekyllrb.com/" version="4.3.4">Jekyll</generator><link href="https://www.sgir.ch/feed.xml" rel="self" type="application/atom+xml"/><link href="https://www.sgir.ch/" rel="alternate" type="text/html" hreflang="en"/><updated>2025-07-27T11:58:27+00:00</updated><id>https://www.sgir.ch/feed.xml</id><title type="html">blank</title><subtitle>Personal blog. Based on [*folio](https://github.com/bogoli/-folio) design. </subtitle><entry><title type="html">KafkaConnect Oracle configuration</title><link href="https://www.sgir.ch/blog/2025/kafkaconnect-oracle/" rel="alternate" type="text/html" title="KafkaConnect Oracle configuration"/><published>2025-01-23T16:02:00+00:00</published><updated>2025-01-23T16:02:00+00:00</updated><id>https://www.sgir.ch/blog/2025/kafkaconnect-oracle</id><content type="html" xml:base="https://www.sgir.ch/blog/2025/kafkaconnect-oracle/"><![CDATA[<h2 id="debezium-connector-for-oracle">Debezium connector for Oracle</h2> <p>Debeziumâ€™s Oracle connector captures and records row-level changes that occur in databases on an Oracle server, including tables that are added while the connector is running.</p> <p>Reference : https://debezium.io/documentation/reference/stable/connectors/oracle.html</p> <h2 id="deployment">Deployment</h2> <div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">kind</span><span class="pi">:</span> <span class="s">KafkaConnector</span>
<span class="na">apiVersion</span><span class="pi">:</span> <span class="s">kafka.strimzi.io/v1beta2</span>
<span class="na">metadata</span><span class="pi">:</span>
  <span class="na">name</span><span class="pi">:</span> <span class="s">kafka-connector-mydatabase-oracle</span>
  <span class="na">labels</span><span class="pi">:</span>
    <span class="na">strimzi.io/cluster</span><span class="pi">:</span> <span class="s">kafka-cluster</span>
  <span class="na">namespace</span><span class="pi">:</span> <span class="s">amq-streams-kafka</span>
<span class="na">spec</span><span class="pi">:</span>
  <span class="na">class</span><span class="pi">:</span> <span class="s">io.debezium.connector.oracle.OracleConnector</span>
  <span class="na">tasksMax</span><span class="pi">:</span> <span class="m">1</span>
  <span class="na">config</span><span class="pi">:</span>
    <span class="na">database.hostname</span><span class="pi">:</span> <span class="s">mydatabase-sql.domain.lan</span>
    <span class="na">database.port</span><span class="pi">:</span> <span class="m">1521</span>
    <span class="na">database.user</span><span class="pi">:</span> <span class="s">debezium</span>
    <span class="na">database.password</span><span class="pi">:</span> <span class="s">password</span>
    <span class="na">database.dbname</span><span class="pi">:</span> <span class="s">mydatabase</span>
    <span class="na">table.include.list</span><span class="pi">:</span> <span class="s">schema.table1</span>
    <span class="na">lob.enabled</span><span class="pi">:</span> <span class="kc">true</span> <span class="c1"># For supporting CLOB/NCLOB column -&gt; https://debezium.io/documentation//reference/2.7/connectors/oracle.html#oracle-property-lob-enabled</span>
    <span class="na">topic.creation.default.replication.factor</span><span class="pi">:</span> <span class="s">-1</span>
    <span class="na">topic.creation.default.partitions</span><span class="pi">:</span> <span class="s">-1</span>
    <span class="na">topic.creation.default.delete.retention.ms</span><span class="pi">:</span> <span class="m">259200000</span>
    <span class="na">topic.prefix</span><span class="pi">:</span> <span class="s">mydatabase</span>
    <span class="na">connect.keep.alive</span><span class="pi">:</span> <span class="kc">true</span>
    <span class="na">schema.history.internal.kafka.bootstrap.servers</span><span class="pi">:</span> <span class="s">kafka-cluster-kafka-bootstrap:9093</span>
    <span class="na">schema.history.internal.kafka.topic</span><span class="pi">:</span> <span class="s">mydatabase.schemahistory</span>
    <span class="na">config.providers</span><span class="pi">:</span> <span class="s">secrets,configmaps</span>
    <span class="na">config.providers.configmaps.class</span><span class="pi">:</span> <span class="s">io.strimzi.kafka.KubernetesConfigMapConfigProvider</span>
    <span class="na">config.providers.secrets.class</span><span class="pi">:</span> <span class="s">io.strimzi.kafka.KubernetesSecretConfigProvider</span>
    <span class="na">schema.history.internal.producer.security.protocol</span><span class="pi">:</span> <span class="s">SASL_SSL</span>
    <span class="na">schema.history.internal.producer.sasl.mechanism</span><span class="pi">:</span> <span class="s">SCRAM-SHA-512</span>
    <span class="na">schema.history.internal.producer.ssl.truststore.type</span><span class="pi">:</span> <span class="s">PEM</span>
    <span class="na">schema.history.internal.producer.ssl.truststore.certificates</span><span class="pi">:</span> <span class="s">${secrets:amq-streams-kafka/kafka-cluster-cluster-ca-cert:ca.crt}</span>
    <span class="na">schema.history.internal.producer.sasl.jaas.config</span><span class="pi">:</span> <span class="s">${secrets:amq-streams-kafka/debezium-admin:sasl.jaas.config}</span>
    <span class="na">schema.history.internal.consumer.security.protocol</span><span class="pi">:</span> <span class="s">SASL_SSL</span>
    <span class="na">schema.history.internal.consumer.sasl.mechanism</span><span class="pi">:</span> <span class="s">SCRAM-SHA-512</span>
    <span class="na">schema.history.internal.consumer.ssl.truststore.type</span><span class="pi">:</span> <span class="s">PEM</span>
    <span class="na">schema.history.internal.consumer.ssl.truststore.certificates</span><span class="pi">:</span> <span class="s">${secrets:amq-streams-kafka/kafka-cluster-cluster-ca-cert:ca.crt}</span>
    <span class="na">schema.history.internal.consumer.sasl.jaas.config</span><span class="pi">:</span> <span class="s">${secrets:amq-streams-kafka/debezium-admin:sasl.jaas.config}</span>
</code></pre></div></div>]]></content><author><name></name></author><category term="kafka"/><category term="kafka,"/><category term="debezium"/><summary type="html"><![CDATA[Debezium connector for Oracle in Kafka OpenShift (AMQ Streams) based on Strimzi]]></summary></entry><entry><title type="html">How to create an Oracle DB link ?</title><link href="https://www.sgir.ch/blog/2025/oracle-dblink/" rel="alternate" type="text/html" title="How to create an Oracle DB link ?"/><published>2025-01-19T15:25:00+00:00</published><updated>2025-01-19T15:25:00+00:00</updated><id>https://www.sgir.ch/blog/2025/oracle-dblink</id><content type="html" xml:base="https://www.sgir.ch/blog/2025/oracle-dblink/"><![CDATA[<h2 id="how-to-create-an-oracle-db-link-">How to create an Oracle DB link ?</h2> <p>From a database X, we wish to display a view located in another database Y.</p> <p>In the Y database:</p> <div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">CREATE</span> <span class="k">OR</span> <span class="k">REPLACE</span> <span class="k">FORCE</span> <span class="n">EDITIONABLE</span> <span class="k">VIEW</span> <span class="nv">"MY_VIEW"</span> <span class="p">(</span><span class="nv">"CustomerName"</span><span class="p">,</span> <span class="nv">"ContactName"</span><span class="p">)</span> <span class="k">AS</span> 
  <span class="k">SELECT</span> 
    <span class="k">C</span><span class="p">.</span><span class="n">CUSTOMERNAME</span> <span class="k">AS</span> <span class="n">CustomerName</span><span class="p">,</span>
    <span class="k">C</span><span class="p">.</span><span class="n">CONTACTNAME</span> <span class="k">AS</span> <span class="n">ContactName</span>
  <span class="k">FROM</span>
    <span class="n">CUSTOMER</span> <span class="k">C</span><span class="p">;</span>
</code></pre></div></div> <p>In the X database:</p> <div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">CREATE</span> <span class="k">PUBLIC</span> <span class="k">DATABASE</span> <span class="n">LINK</span> <span class="n">MY_DB_LINK_TO_Y</span> <span class="k">CONNECT</span> <span class="k">TO</span> <span class="o">&lt;</span><span class="n">remoteuser</span><span class="o">&gt;</span> <span class="n">IDENTIFIED</span> <span class="k">BY</span> <span class="nv">"&lt;password&gt;"</span> <span class="k">USING</span> <span class="s1">'db_y.domain.lan:1521/&lt;SID&gt;'</span><span class="p">;</span>
</code></pre></div></div> <p>Access the remote view through the DB link :</p> <div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">select</span> <span class="o">*</span> <span class="k">from</span> <span class="o">&lt;</span><span class="n">myschema</span><span class="o">&gt;</span><span class="p">.</span><span class="nv">"MY_VIEW"</span> <span class="o">@</span><span class="n">MY_DB_LINK_TO_Y</span><span class="p">;</span>
</code></pre></div></div>]]></content><author><name></name></author><category term="database"/><category term="oracle,"/><category term="tips"/><summary type="html"><![CDATA[How to create an Oracle DB link ?]]></summary></entry><entry><title type="html">KafkaConnect PostgreSQL configuration</title><link href="https://www.sgir.ch/blog/2025/kafkaconnect-postgresql/" rel="alternate" type="text/html" title="KafkaConnect PostgreSQL configuration"/><published>2025-01-03T14:35:00+00:00</published><updated>2025-01-03T14:35:00+00:00</updated><id>https://www.sgir.ch/blog/2025/kafkaconnect-postgresql</id><content type="html" xml:base="https://www.sgir.ch/blog/2025/kafkaconnect-postgresql/"><![CDATA[<h2 id="debezium-connector-for-postgresql">Debezium connector for PostgreSQL</h2> <p>The Debezium PostgreSQL connector captures row-level changes in the schemas of a PostgreSQL database</p> <p>Reference : https://debezium.io/documentation/reference/stable/connectors/postgresql.html</p> <h2 id="deployment">Deployment</h2> <div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">kind</span><span class="pi">:</span> <span class="s">KafkaConnector</span>
<span class="na">apiVersion</span><span class="pi">:</span> <span class="s">kafka.strimzi.io/v1beta2</span>
<span class="na">metadata</span><span class="pi">:</span>
  <span class="na">name</span><span class="pi">:</span> <span class="s">kafka-connector-mydatabase-postgresql</span>
  <span class="na">labels</span><span class="pi">:</span>
    <span class="na">strimzi.io/cluster</span><span class="pi">:</span> <span class="s">kafka-cluster</span>
  <span class="na">namespace</span><span class="pi">:</span> <span class="s">amq-streams-kafka</span>
<span class="na">spec</span><span class="pi">:</span>
 <span class="na">class</span><span class="pi">:</span> <span class="s">io.debezium.connector.postgresql.PostgresConnector</span>
  <span class="s">tasksMax</span><span class="err">:</span> <span class="m">1</span>
  <span class="na">config</span><span class="pi">:</span>
    <span class="na">database.hostname</span><span class="pi">:</span> <span class="s">mydatabase-sql.domain.lan</span>
    <span class="na">database.port</span><span class="pi">:</span> <span class="m">5432</span>
    <span class="na">database.user</span><span class="pi">:</span> <span class="s">debezium</span>
    <span class="na">database.password</span><span class="pi">:</span> <span class="s">password</span>
    <span class="na">database.dbname</span><span class="pi">:</span> <span class="s">mydatabase</span>
    <span class="na">database.sslmode</span><span class="pi">:</span> <span class="s">verify-full</span>
    <span class="na">database.sslrootcert</span><span class="pi">:</span> <span class="s">/opt/kafka/external-configuration/ca-bundle/ca-certificates.crt</span> <span class="c1"># internal PKI</span>
    <span class="na">table.include.list</span><span class="pi">:</span> <span class="s">public.table1</span>
    <span class="na">topic.prefix</span><span class="pi">:</span> <span class="s">mydatabase</span>
    <span class="na">plugin.name</span><span class="pi">:</span> <span class="s">pgoutput</span>
    <span class="na">slot.name</span><span class="pi">:</span> <span class="s">permanent_logical_slot_mydatabase</span>
    <span class="na">publication.name</span><span class="pi">:</span> <span class="s">publication_mydatabase</span>
    <span class="na">publication.autocreate.mode</span><span class="pi">:</span> <span class="s">filtered</span>
    <span class="na">schema.history.internal.kafka.bootstrap.servers</span><span class="pi">:</span> <span class="s">kafka-cluster-kafka-bootstrap:9093</span>
    <span class="na">schema.history.internal.kafka.topic</span><span class="pi">:</span> <span class="s">mydatabase.schemahistory</span>
    <span class="na">config.providers</span><span class="pi">:</span> <span class="s">secrets,configmaps</span>
    <span class="na">config.providers.configmaps.class</span><span class="pi">:</span> <span class="s">io.strimzi.kafka.KubernetesConfigMapConfigProvider</span>
    <span class="na">config.providers.secrets.class</span><span class="pi">:</span> <span class="s">io.strimzi.kafka.KubernetesSecretConfigProvider</span>
    <span class="na">topic.creation.default.replication.factor</span><span class="pi">:</span> <span class="s">-1</span>
    <span class="na">topic.creation.default.partitions</span><span class="pi">:</span> <span class="s">-1</span>
    <span class="na">topic.creation.default.delete.retention.ms</span><span class="pi">:</span> <span class="m">259200000</span>
    <span class="na">schema.history.internal.producer.security.protocol</span><span class="pi">:</span> <span class="s">SASL_SSL</span>
    <span class="na">schema.history.internal.producer.sasl.mechanism</span><span class="pi">:</span> <span class="s">SCRAM-SHA-512</span>
    <span class="na">schema.history.internal.producer.ssl.truststore.type</span><span class="pi">:</span> <span class="s">PEM</span>
    <span class="na">schema.history.internal.producer.ssl.truststore.certificates</span><span class="pi">:</span> <span class="s">${secrets:amq-streams-kafka/kafka-cluster-cluster-ca-cert:ca.crt}</span>
    <span class="na">schema.history.internal.producer.sasl.jaas.config</span><span class="pi">:</span> <span class="s">${secrets:amq-streams-kafka/debezium-admin:sasl.jaas.config}</span>
    <span class="na">schema.history.internal.consumer.security.protocol</span><span class="pi">:</span> <span class="s">SASL_SSL</span>
    <span class="na">schema.history.internal.consumer.sasl.mechanism</span><span class="pi">:</span> <span class="s">SCRAM-SHA-512</span>
    <span class="na">schema.history.internal.consumer.ssl.truststore.type</span><span class="pi">:</span> <span class="s">PEM</span>
    <span class="na">schema.history.internal.consumer.ssl.truststore.certificates</span><span class="pi">:</span> <span class="s">${secrets:amq-streams-kafka/kafka-cluster-cluster-ca-cert:ca.crt}</span>
    <span class="na">schema.history.internal.consumer.sasl.jaas.config</span><span class="pi">:</span> <span class="s">${secrets:amq-streams-kafka/debezium-admin:sasl.jaas.config}</span>
</code></pre></div></div>]]></content><author><name></name></author><category term="kafka"/><category term="kafka,"/><category term="debezium"/><summary type="html"><![CDATA[Debezium connector for PostgreSQL in Kafka OpenShift (AMQ Streams) based on Strimzi]]></summary></entry><entry><title type="html">KafkaConnect SQL Server configuration</title><link href="https://www.sgir.ch/blog/2025/kafkaconnect-sqlserver/" rel="alternate" type="text/html" title="KafkaConnect SQL Server configuration"/><published>2025-01-02T14:27:00+00:00</published><updated>2025-01-02T14:27:00+00:00</updated><id>https://www.sgir.ch/blog/2025/kafkaconnect-sqlserver</id><content type="html" xml:base="https://www.sgir.ch/blog/2025/kafkaconnect-sqlserver/"><![CDATA[<h2 id="debezium-connector-for-sql-server">Debezium connector for SQL Server</h2> <p>The Debezium SQL Server connector captures row-level changes that occur in the schemas of a SQL Server database.</p> <p>Reference : https://debezium.io/documentation/reference/stable/connectors/sqlserver.html</p> <h2 id="deployment">Deployment</h2> <div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">kind</span><span class="pi">:</span> <span class="s">KafkaConnector</span>
<span class="na">apiVersion</span><span class="pi">:</span> <span class="s">kafka.strimzi.io/v1beta2</span>
<span class="na">metadata</span><span class="pi">:</span>
  <span class="na">name</span><span class="pi">:</span> <span class="s">kafka-connector-mydatabase-sqlserver</span>
  <span class="na">labels</span><span class="pi">:</span>
    <span class="na">strimzi.io/cluster</span><span class="pi">:</span> <span class="s">kafka-cluster</span>
  <span class="na">namespace</span><span class="pi">:</span> <span class="s">amq-streams-kafka</span>
<span class="na">spec</span><span class="pi">:</span>
  <span class="na">class</span><span class="pi">:</span> <span class="s">io.debezium.connector.sqlserver.SqlServerConnector</span>
  <span class="na">tasksMax</span><span class="pi">:</span> <span class="m">1</span>
  <span class="na">config</span><span class="pi">:</span>
    <span class="na">database.hostname</span><span class="pi">:</span> <span class="s">mydatabase-sql.domain.lan</span>
    <span class="na">database.port</span><span class="pi">:</span> <span class="m">1433</span>
    <span class="na">database.user</span><span class="pi">:</span> <span class="s">debezium</span>
    <span class="na">database.password</span><span class="pi">:</span> <span class="s">password</span>
    <span class="na">database.names</span><span class="pi">:</span> <span class="s">mydatabase</span>
    <span class="na">database.encrypt</span><span class="pi">:</span> <span class="kc">true</span>
    <span class="na">database.trustServerCertificate</span><span class="pi">:</span> <span class="kc">true</span>
    <span class="na">database.hostNameInCertificate</span><span class="pi">:</span> <span class="s">mydatabase-sql.domain.lan</span>
    <span class="na">database.ssl.truststore.type</span><span class="pi">:</span> <span class="s">JKS</span>
    <span class="na">database.ssl.truststore</span><span class="pi">:</span> <span class="s">${secrets:amq-streams-kafka/pki-ca-certs:jks}</span> <span class="c1"># internal PKI</span>
    <span class="na">database.ssl.truststore.password</span><span class="pi">:</span> <span class="s">${secrets:amq-streams-kafka/pki-ca-certs:password}</span>
    <span class="na">topic.prefix</span><span class="pi">:</span> <span class="s">mydatabase</span>
    <span class="na">config.providers</span><span class="pi">:</span> <span class="s">secrets,configmaps</span>
    <span class="na">schema.history.internal.kafka.bootstrap.servers</span><span class="pi">:</span> <span class="s">kafka-cluster-bootstrap:9093</span>
    <span class="na">schema.history.internal.kafka.topic</span><span class="pi">:</span> <span class="s">mydatabase.schemahistory.mydatabase</span>
    <span class="na">config.providers.configmaps.class</span><span class="pi">:</span> <span class="s">io.strimzi.kafka.KubernetesConfigMapConfigProvider</span>
    <span class="na">config.providers.secrets.class</span><span class="pi">:</span> <span class="s">io.strimzi.kafka.KubernetesSecretConfigProvider</span>
    <span class="na">topic.creation.default.replication.factor</span><span class="pi">:</span> <span class="s">-1</span>
    <span class="na">topic.creation.default.partitions</span><span class="pi">:</span> <span class="s">-1</span>
    <span class="na">topic.creation.default.delete.retention.ms</span><span class="pi">:</span> <span class="m">259200000</span>
    <span class="na">schema.history.internal.producer.security.protocol</span><span class="pi">:</span> <span class="s">SASL_SSL</span>
    <span class="na">schema.history.internal.producer.sasl.mechanism</span><span class="pi">:</span> <span class="s">SCRAM-SHA-512</span>
    <span class="na">schema.history.internal.producer.ssl.truststore.type</span><span class="pi">:</span> <span class="s">PEM</span>
    <span class="na">schema.history.internal.producer.ssl.truststore.certificates</span><span class="pi">:</span> <span class="s">${secrets:amq-streams-kafka/kafka-cluster-ca-cert:ca.crt}</span>
    <span class="na">schema.history.internal.producer.sasl.jaas.config</span><span class="pi">:</span> <span class="s">${secrets:amq-streams-kafka/debezium-admin:sasl.jaas.config}</span>
    <span class="na">schema.history.internal.consumer.security.protocol</span><span class="pi">:</span> <span class="s">SASL_SSL</span>
    <span class="na">schema.history.internal.consumer.sasl.mechanism</span><span class="pi">:</span> <span class="s">SCRAM-SHA-512</span>
    <span class="na">schema.history.internal.consumer.ssl.truststore.type</span><span class="pi">:</span> <span class="s">PEM</span>
    <span class="na">schema.history.internal.consumer.ssl.truststore.certificates</span><span class="pi">:</span> <span class="s">${secrets:amq-streams-kafka/kafka-cluster-ca-cert:ca.crt}</span>
    <span class="na">schema.history.internal.consumer.sasl.jaas.config</span><span class="pi">:</span> <span class="s">${secrets:amq-streams-kafka/debezium-admin:sasl.jaas.config}</span>
</code></pre></div></div>]]></content><author><name></name></author><category term="kafka"/><category term="kafka,"/><category term="debezium"/><summary type="html"><![CDATA[Debezium connector for SQL Server in Kafka OpenShift (AMQ Streams) based on Strimzi]]></summary></entry><entry><title type="html">KafkaConnect MariaDB configuration</title><link href="https://www.sgir.ch/blog/2025/kafkaconnect-mariadb/" rel="alternate" type="text/html" title="KafkaConnect MariaDB configuration"/><published>2025-01-01T14:13:00+00:00</published><updated>2025-01-01T14:13:00+00:00</updated><id>https://www.sgir.ch/blog/2025/kafkaconnect-mariadb</id><content type="html" xml:base="https://www.sgir.ch/blog/2025/kafkaconnect-mariadb/"><![CDATA[<h2 id="debezium-connector-for-mariadb">Debezium connector for MariaDB</h2> <p>MariaDB has a binary log (binlog) that records all operations in the order in which they are committed to the database. This includes changes to table schemas as well as changes to the data in tables. MariaDB uses the binlog for replication and recovery.</p> <p>The Debezium MariaDB connector reads the binlog, produces change events for row-level INSERT, UPDATE, and DELETE operations, and emits the change events to Kafka topics. Client applications read those Kafka topics.</p> <p>Reference : https://debezium.io/documentation/reference/stable/connectors/mariadb.html</p> <h2 id="deployment">Deployment</h2> <div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">kind</span><span class="pi">:</span> <span class="s">KafkaConnector</span>
<span class="na">apiVersion</span><span class="pi">:</span> <span class="s">kafka.strimzi.io/v1beta2</span>
<span class="na">metadata</span><span class="pi">:</span>
  <span class="na">name</span><span class="pi">:</span> <span class="s">kafka-connector-mydatabase-mariadb</span>
  <span class="na">labels</span><span class="pi">:</span>
    <span class="na">strimzi.io/cluster</span><span class="pi">:</span> <span class="s">kafka-cluster</span>
  <span class="na">namespace</span><span class="pi">:</span> <span class="s">amq-streams-kafka</span>
<span class="na">spec</span><span class="pi">:</span>
  <span class="na">class</span><span class="pi">:</span> <span class="s">io.debezium.connector.mariadb.MariaDbConnector</span>
  <span class="na">tasksMax</span><span class="pi">:</span> <span class="m">1</span>
  <span class="na">config</span><span class="pi">:</span>
    <span class="na">database.hostname</span><span class="pi">:</span> <span class="s">mydatabase-sql.domain.lan</span>
    <span class="na">database.port</span><span class="pi">:</span> <span class="m">3306</span>
    <span class="na">database.user</span><span class="pi">:</span> <span class="s">debezium</span>
    <span class="na">database.password</span><span class="pi">:</span> <span class="s">password</span>
    <span class="na">database.include.list</span><span class="pi">:</span> <span class="s">mydatabase</span>
    <span class="na">database.sslrootcert</span><span class="pi">:</span> <span class="s">/opt/kafka/external-configuration/ca-bundle/ca-certificates.crt</span> <span class="c1"># internal PKI</span>
    <span class="na">database.server.id</span><span class="pi">:</span> <span class="m">666</span> <span class="c1"># must be unique for each connector</span>
    <span class="na">database.ssl.mode</span><span class="pi">:</span> <span class="s">disabled</span>
    <span class="na">topic.creation.default.replication.factor</span><span class="pi">:</span> <span class="s">-1</span>
    <span class="na">topic.creation.default.partitions</span><span class="pi">:</span> <span class="s">-1</span>
    <span class="na">topic.creation.default.delete.retention.ms</span><span class="pi">:</span> <span class="m">259200000</span>
    <span class="na">topic.prefix</span><span class="pi">:</span> <span class="s">mydatabase</span>
    <span class="na">connect.keep.alive</span><span class="pi">:</span> <span class="kc">true</span>
    <span class="na">include.schema.changes</span><span class="pi">:</span> <span class="kc">true</span>
    <span class="na">schema.history.internal.kafka.bootstrap.servers</span><span class="pi">:</span> <span class="s">kafka-cluster-bootstrap:9093</span>
    <span class="na">schema.history.internal.kafka.topic</span><span class="pi">:</span> <span class="s">mydatabase.schemahistory</span>
    <span class="na">config.providers</span><span class="pi">:</span> <span class="s">secrets,configmaps</span>
    <span class="na">config.providers.configmaps.class</span><span class="pi">:</span> <span class="s">io.strimzi.kafka.KubernetesConfigMapConfigProvider</span>
    <span class="na">config.providers.secrets.class</span><span class="pi">:</span> <span class="s">io.strimzi.kafka.KubernetesSecretConfigProvider</span>
    <span class="na">schema.history.internal.producer.security.protocol</span><span class="pi">:</span> <span class="s">SASL_SSL</span>
    <span class="na">schema.history.internal.producer.sasl.mechanism</span><span class="pi">:</span> <span class="s">SCRAM-SHA-512</span>
    <span class="na">schema.history.internal.producer.ssl.truststore.type</span><span class="pi">:</span> <span class="s">PEM</span>
    <span class="na">schema.history.internal.producer.ssl.truststore.certificates</span><span class="pi">:</span> <span class="s">${secrets:amq-streams-kafka/kafka-cluster-ca-cert:ca.crt}</span>
    <span class="na">schema.history.internal.producer.sasl.jaas.config</span><span class="pi">:</span> <span class="s">${secrets:amq-streams-kafka/debezium-admin:sasl.jaas.config}</span>
    <span class="na">schema.history.internal.consumer.security.protocol</span><span class="pi">:</span> <span class="s">SASL_SSL</span>
    <span class="na">schema.history.internal.consumer.sasl.mechanism</span><span class="pi">:</span> <span class="s">SCRAM-SHA-512</span>
    <span class="na">schema.history.internal.consumer.ssl.truststore.type</span><span class="pi">:</span> <span class="s">PEM</span>
    <span class="na">schema.history.internal.consumer.ssl.truststore.certificates</span><span class="pi">:</span> <span class="s">${secrets:amq-streams-kafka/kafka-cluster-ca-cert:ca.crt}</span>
    <span class="na">schema.history.internal.consumer.sasl.jaas.config</span><span class="pi">:</span> <span class="s">${secrets:amq-streams-kafka/debezium-admin:sasl.jaas.config}</span>
</code></pre></div></div>]]></content><author><name></name></author><category term="kafka"/><category term="kafka,"/><category term="debezium"/><summary type="html"><![CDATA[Debezium connector for MariaDB in Kafka OpenShift (AMQ Streams) based on Strimzi]]></summary></entry><entry><title type="html">access a kafka topic with kafka-console-consumer</title><link href="https://www.sgir.ch/blog/2024/kafka-console-consumer/" rel="alternate" type="text/html" title="access a kafka topic with kafka-console-consumer"/><published>2024-12-06T13:20:00+00:00</published><updated>2024-12-06T13:20:00+00:00</updated><id>https://www.sgir.ch/blog/2024/kafka-console-consumer</id><content type="html" xml:base="https://www.sgir.ch/blog/2024/kafka-console-consumer/"><![CDATA[<h2 id="create-the-configuration-file">Create the configuration file</h2> <p>Create a file <code class="language-plaintext highlighter-rouge">consumer.properties</code> with:</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ssl.truststore.type<span class="o">=</span>PEM
ssl.truststore.location<span class="o">=</span>&lt;certificat path&gt;.crt
security.protocol<span class="o">=</span>SASL_SSL
sasl.mechanism<span class="o">=</span>SCRAM-SHA-512
sasl.jaas.config<span class="o">=</span>org.apache.kafka.common.security.scram.ScramLoginModule required <span class="nv">username</span><span class="o">=</span><span class="s2">"&lt;user&gt;"</span> <span class="nv">password</span><span class="o">=</span><span class="s2">"&lt;password&gt;"</span><span class="p">;</span>
</code></pre></div></div> <p>Connect to the topic:</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>/usr/local/kafka/kafka_2.13-3.6.2/bin/kafka-console-consumer.sh <span class="nt">--bootstrap-server</span> &lt;bootstrap-url&gt; <span class="nt">--consumer</span>.config consumer.properties <span class="nt">--topic</span> &lt;topic name&gt;
</code></pre></div></div>]]></content><author><name></name></author><category term="kafka"/><category term="kakfa,"/><category term="tips"/><summary type="html"><![CDATA[How to access a Kafka Topic with kafka-console-consumer]]></summary></entry><entry><title type="html">Enable CDC for Oracle</title><link href="https://www.sgir.ch/blog/2024/cdc-enable-oracle/" rel="alternate" type="text/html" title="Enable CDC for Oracle"/><published>2024-12-06T13:15:00+00:00</published><updated>2024-12-06T13:15:00+00:00</updated><id>https://www.sgir.ch/blog/2024/cdc-enable-oracle</id><content type="html" xml:base="https://www.sgir.ch/blog/2024/cdc-enable-oracle/"><![CDATA[<h2 id="enable-cdc-for-oracle">Enable CDC for Oracle</h2> <div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">ALTER</span> <span class="k">DATABASE</span> <span class="k">ADD</span> <span class="n">SUPPLEMENTAL</span> <span class="n">LOG</span> <span class="k">DATA</span><span class="p">;</span>
 
<span class="k">SELECT</span> <span class="n">supplemental_log_data_min</span> <span class="k">FROM</span> <span class="n">v</span><span class="err">$</span><span class="k">database</span><span class="p">;</span>
 
<span class="k">CREATE</span> <span class="n">TABLESPACE</span> <span class="n">logminer_tbs</span> <span class="n">DATAFILE</span> <span class="s1">'/u02/data/&lt;db name&gt;/datafile/logminer_tbs.dbf'</span> <span class="k">SIZE</span> <span class="mi">256</span><span class="n">M</span> <span class="n">REUSE</span> <span class="n">AUTOEXTEND</span> <span class="k">ON</span> <span class="n">MAXSIZE</span> <span class="n">UNLIMITED</span><span class="p">;</span>
</code></pre></div></div> <p>Create an Oracle user for accessing the database:</p> <div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">CREATE</span> <span class="k">USER</span> <span class="n">cdc</span> <span class="n">IDENTIFIED</span> <span class="k">BY</span> <span class="nv">"xxx"</span> <span class="k">DEFAULT</span> <span class="n">TABLESPACE</span> <span class="n">LOGMINER_TBS</span> <span class="n">QUOTA</span> <span class="n">UNLIMITED</span> <span class="k">ON</span> <span class="n">LOGMINER_TBS</span> <span class="p">;</span>
  
<span class="k">GRANT</span> <span class="k">CREATE</span> <span class="k">SESSION</span> <span class="k">TO</span> <span class="n">cdc</span> <span class="p">;</span>
<span class="k">GRANT</span> <span class="k">SET</span> <span class="n">CONTAINER</span> <span class="k">TO</span> <span class="n">cdc</span> <span class="p">;</span>
<span class="k">GRANT</span> <span class="k">SELECT</span> <span class="k">ON</span> <span class="n">V_</span><span class="err">$</span><span class="k">DATABASE</span> <span class="k">TO</span> <span class="n">cdc</span> <span class="p">;</span>
<span class="k">GRANT</span> <span class="n">FLASHBACK</span> <span class="k">ANY</span> <span class="k">TABLE</span> <span class="k">TO</span> <span class="n">cdc</span> <span class="p">;</span>
<span class="k">GRANT</span> <span class="k">SELECT</span> <span class="k">ANY</span> <span class="k">TABLE</span> <span class="k">TO</span> <span class="n">cdc</span> <span class="p">;</span>
<span class="k">GRANT</span> <span class="n">SELECT_CATALOG_ROLE</span> <span class="k">TO</span> <span class="n">cdc</span> <span class="p">;</span>
<span class="k">GRANT</span> <span class="n">EXECUTE_CATALOG_ROLE</span> <span class="k">TO</span> <span class="n">cdc</span> <span class="p">;</span>
<span class="k">GRANT</span> <span class="k">SELECT</span> <span class="k">ANY</span> <span class="n">TRANSACTION</span> <span class="k">TO</span> <span class="n">cdc</span> <span class="p">;</span>
<span class="k">GRANT</span> <span class="k">SELECT</span> <span class="k">ANY</span> <span class="k">DICTIONARY</span> <span class="k">TO</span> <span class="n">cdc</span> <span class="p">;</span>
<span class="k">GRANT</span> <span class="n">LOGMINING</span> <span class="k">TO</span> <span class="n">cdc</span> <span class="p">;</span>
 
<span class="k">GRANT</span> <span class="k">CREATE</span> <span class="k">TABLE</span> <span class="k">TO</span> <span class="n">cdc</span> <span class="p">;</span>
<span class="k">GRANT</span> <span class="k">LOCK</span> <span class="k">ANY</span> <span class="k">TABLE</span> <span class="k">TO</span> <span class="n">cdc</span> <span class="p">;</span>
<span class="k">GRANT</span> <span class="k">CREATE</span> <span class="n">SEQUENCE</span> <span class="k">TO</span> <span class="n">cdc</span> <span class="p">;</span>
 
<span class="k">GRANT</span> <span class="k">EXECUTE</span> <span class="k">ON</span> <span class="n">DBMS_LOGMNR</span> <span class="k">TO</span> <span class="n">cdc</span> <span class="p">;</span>
<span class="k">GRANT</span> <span class="k">EXECUTE</span> <span class="k">ON</span> <span class="n">DBMS_LOGMNR_D</span> <span class="k">TO</span> <span class="n">cdc</span> <span class="p">;</span>
 
<span class="k">GRANT</span> <span class="k">SELECT</span> <span class="k">ON</span> <span class="n">V_</span><span class="err">$</span><span class="n">LOG</span> <span class="k">TO</span> <span class="n">cdc</span> <span class="p">;</span>
<span class="k">GRANT</span> <span class="k">SELECT</span> <span class="k">ON</span> <span class="n">V_</span><span class="err">$</span><span class="n">LOG_HISTORY</span> <span class="k">TO</span> <span class="n">cdc</span> <span class="p">;</span>
<span class="k">GRANT</span> <span class="k">SELECT</span> <span class="k">ON</span> <span class="n">V_</span><span class="err">$</span><span class="n">LOGMNR_LOGS</span> <span class="k">TO</span> <span class="n">cdc</span> <span class="p">;</span>
<span class="k">GRANT</span> <span class="k">SELECT</span> <span class="k">ON</span> <span class="n">V_</span><span class="err">$</span><span class="n">LOGMNR_CONTENTS</span> <span class="k">TO</span> <span class="n">cdc</span> <span class="p">;</span>
<span class="k">GRANT</span> <span class="k">SELECT</span> <span class="k">ON</span> <span class="n">V_</span><span class="err">$</span><span class="n">LOGMNR_PARAMETERS</span> <span class="k">TO</span> <span class="n">cdc</span> <span class="p">;</span>
<span class="k">GRANT</span> <span class="k">SELECT</span> <span class="k">ON</span> <span class="n">V_</span><span class="err">$</span><span class="n">LOGFILE</span> <span class="k">TO</span> <span class="n">cdc</span> <span class="p">;</span>
<span class="k">GRANT</span> <span class="k">SELECT</span> <span class="k">ON</span> <span class="n">V_</span><span class="err">$</span><span class="n">ARCHIVED_LOG</span> <span class="k">TO</span> <span class="n">cdc</span> <span class="p">;</span>
<span class="k">GRANT</span> <span class="k">SELECT</span> <span class="k">ON</span> <span class="n">V_</span><span class="err">$</span><span class="n">ARCHIVE_DEST_STATUS</span> <span class="k">TO</span> <span class="n">cdc</span> <span class="p">;</span>
<span class="k">GRANT</span> <span class="k">SELECT</span> <span class="k">ON</span> <span class="n">V_</span><span class="err">$</span><span class="n">TRANSACTION</span> <span class="k">TO</span> <span class="n">cdc</span> <span class="p">;</span>
</code></pre></div></div> <p>Enable supplemental logs for tables:</p> <div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">ALTER</span> <span class="k">TABLE</span> <span class="o">&lt;</span><span class="k">schema</span><span class="o">&gt;</span><span class="p">.</span><span class="o">&lt;</span><span class="k">table</span><span class="o">&gt;</span> <span class="k">ADD</span> <span class="n">SUPPLEMENTAL</span> <span class="n">LOG</span> <span class="k">DATA</span> <span class="p">(</span><span class="k">ALL</span><span class="p">)</span> <span class="n">COLUMNS</span>
<span class="k">ALTER</span> <span class="k">TABLE</span> <span class="o">&lt;</span><span class="k">schema</span><span class="o">&gt;</span><span class="p">.</span><span class="o">&lt;</span><span class="k">table</span><span class="o">&gt;</span> <span class="k">ADD</span> <span class="n">SUPPLEMENTAL</span> <span class="n">LOG</span> <span class="k">DATA</span> <span class="p">(</span><span class="k">ALL</span><span class="p">)</span> <span class="n">COLUMNS</span>
</code></pre></div></div>]]></content><author><name></name></author><category term="database"/><category term="debezium,"/><category term="cdc"/><summary type="html"><![CDATA[Enable CDC for Oracle for capturing data]]></summary></entry><entry><title type="html">Enable CDC for PostgreSQL</title><link href="https://www.sgir.ch/blog/2024/cdc-enable-postgresql/" rel="alternate" type="text/html" title="Enable CDC for PostgreSQL"/><published>2024-12-06T13:15:00+00:00</published><updated>2024-12-06T13:15:00+00:00</updated><id>https://www.sgir.ch/blog/2024/cdc-enable-postgresql</id><content type="html" xml:base="https://www.sgir.ch/blog/2024/cdc-enable-postgresql/"><![CDATA[<h2 id="enable-cdc-for-postgresql-with-patroni">Enable CDC for PostgreSQL with Patroni</h2> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Check cluster</span>
/usr/local/bin/patronictl <span class="nt">-c</span> /etc/patroni/patroni.yml list
 
<span class="c"># Edit configuration</span>
/usr/local/bin/patronictl <span class="nt">-c</span> /etc/patroni/patroni.yml edit-config
</code></pre></div></div> <p>Add a permanent slot:</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>slots:
  permanent_logical_slot_&lt;db name&gt;:
    database: &lt;db name&gt;
    plugin: pgoutput
    <span class="nb">type</span>: logical
</code></pre></div></div> <p>Exit text editor and validate change.</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Check if a reboot is required</span>
/usr/local/bin/patronictl <span class="nt">-c</span> /etc/patroni/patroni.yml list
 
<span class="c"># Restart the cluster</span>
/usr/local/bin/patronictl <span class="nt">-c</span> /etc/patroni/patroni.yml restart &lt;cluster-name&gt;
 
<span class="c"># Check cluster</span>
/usr/local/bin/patronictl <span class="nt">-c</span> /etc/patroni/patroni.yml list
 
<span class="c"># Check log</span>
<span class="nb">tail</span> <span class="nt">-f</span> /data/postgres/pg_log/postgresql-<span class="k">*</span>.log
</code></pre></div></div> <p>Create a PostgreSQL user for accessing the database:</p> <div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">GRANT</span> <span class="k">CREATE</span> <span class="k">ON</span> <span class="k">DATABASE</span> <span class="o">&lt;</span><span class="n">db</span><span class="o">&gt;</span> <span class="k">TO</span> <span class="n">debezium</span><span class="p">;</span>
 
<span class="c1">-- connect to correct database</span>
<span class="err">\</span><span class="k">c</span> <span class="o">&lt;</span><span class="n">db</span> <span class="n">name</span><span class="o">&gt;</span> <span class="c1">--switch to correct db</span>
<span class="k">GRANT</span> <span class="k">ALL</span> <span class="k">ON</span> <span class="k">SCHEMA</span> <span class="k">public</span> <span class="k">TO</span> <span class="n">debezium_group</span><span class="p">;</span>
 
<span class="k">GRANT</span> <span class="n">debezium_group</span> <span class="k">TO</span> <span class="o">&lt;</span><span class="k">current</span> <span class="k">object</span> <span class="k">owner</span><span class="o">&gt;</span><span class="p">;</span>
</code></pre></div></div> <p>Validate the replication slots and publication:</p> <div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">-- check output of the command</span>
<span class="err">\</span><span class="k">c</span> <span class="n">postgres</span>
<span class="k">select</span> <span class="o">*</span> <span class="k">from</span> <span class="n">pg_replication_slots</span><span class="p">;</span>
 
<span class="err">\</span><span class="k">c</span> <span class="o">&lt;</span><span class="n">db</span> <span class="n">name</span><span class="o">&gt;</span>
<span class="k">select</span> <span class="o">*</span> <span class="k">from</span> <span class="n">pg_publication</span><span class="p">;</span>
<span class="k">select</span> <span class="o">*</span> <span class="k">from</span> <span class="n">pg_publication_tables</span><span class="p">;</span>
</code></pre></div></div>]]></content><author><name></name></author><category term="database"/><category term="debezium,"/><category term="cdc"/><summary type="html"><![CDATA[Enable CDC for PostgreSQL for capturing data]]></summary></entry><entry><title type="html">OpenSSL for humans</title><link href="https://www.sgir.ch/blog/2024/openssl/" rel="alternate" type="text/html" title="OpenSSL for humans"/><published>2024-12-01T15:09:00+00:00</published><updated>2024-12-01T15:09:00+00:00</updated><id>https://www.sgir.ch/blog/2024/openssl</id><content type="html" xml:base="https://www.sgir.ch/blog/2024/openssl/"><![CDATA[<h2 id="validation">Validation</h2> <p>Various tips to validate certificate</p> <h3 id="dane">DANE</h3> <p>This theme implements a built-in Jekyll feature, the use of Rouge, for syntax highlighting. It supports more than 100 languages. This example is in C++. All you have to do is wrap your code in markdown code tags:</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>openssl s_client <span class="nt">-starttls</span> smtp <span class="se">\</span>
<span class="nt">-connect</span> mail.protonmail.ch:25 <span class="se">\</span>
<span class="nt">-dane_tlsa_domain</span> mail.protonmail.ch <span class="se">\</span>
<span class="nt">-dane_tlsa_rrdata</span> <span class="s2">"3 1 1 76BB66711DA416433CA890A5B2E5A0533C6006478F7D10A4469A947ACC8399E1"</span>
</code></pre></div></div> <p>If the verification is successful, you will see something like this in the output:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>SSL handshake has read 5209 bytes and written 433 bytes Verification: OK Verified peername: *.protonmail.ch DANE TLSA 3 1 1 ...8f7d10a4469a947acc8399e1 matched EE certificate at depth 0
</code></pre></div></div> <p>If youâ€™d like to test for validation failure, just break the supplied hash. The result will be similar to the following output:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>SSL handshake has read 5209 bytes and written 433 bytes Verification error: No matching DANE TLSA records
</code></pre></div></div>]]></content><author><name></name></author><category term="linux"/><category term="openssl"/><summary type="html"><![CDATA[Usefull openssl examples]]></summary></entry><entry><title type="html">How to change Kafka SSL certificat in OpenShift (AMQ Streams)</title><link href="https://www.sgir.ch/blog/2024/kafka-change-certificat/" rel="alternate" type="text/html" title="How to change Kafka SSL certificat in OpenShift (AMQ Streams)"/><published>2024-12-01T15:09:00+00:00</published><updated>2024-12-01T15:09:00+00:00</updated><id>https://www.sgir.ch/blog/2024/kafka-change-certificat</id><content type="html" xml:base="https://www.sgir.ch/blog/2024/kafka-change-certificat/"><![CDATA[<h2 id="generate-the-new-certificat">Generate the new certificat</h2> <p>Create the <code class="language-plaintext highlighter-rouge">wildcard_subdomain_&lt;kafka-cluster&gt;_&lt;year&gt;.conf</code>:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[ req ]
default_bits = 2048
default_md = sha256
prompt = no
encrypt_key = no
distinguished_name = dn
req_extensions = req_ext
[ dn ]
CN = *.&lt;kafka-cluster&gt;.domain.ch
emailAddress = xxx@domain.ch
O = My Company
OU = IT
L = Rechy
ST = Valais
C = CH
[ req_ext ]
subjectAltName = @alt_names
[ alt_names ]
DNS.1 = *.&lt;kafka-cluster&gt;.domain.ch
</code></pre></div></div> <p>Generate the CSR:</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>openssl req <span class="nt">-new</span> <span class="nt">-out</span> wildcard_subdomain_&lt;kafka-cluster&gt;.domain.ch.csr <span class="nt">-keyout</span> wildcard_subdomain_&lt;kafka-cluster&gt;.domain.ch.key <span class="nt">-config</span> wildcard_subdomain_&lt;kafka-cluster&gt;.domain.ch_&lt;year&gt;.conf
</code></pre></div></div> <p>Submit the request to your CA.</p> <h2 id="add-the-new-certificat">Add the new certificat</h2> <p>Disable reconciliation of Kafka cluster:</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>oc annotate Kafka &lt;kafka-cluster&gt; strimzi.io/pause-reconciliation<span class="o">=</span><span class="s2">"true"</span>
</code></pre></div></div> <p>Update the Kafka CRD to disable certificate management:</p> <div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">apiVersion</span><span class="pi">:</span> <span class="s">kafka.strimzi.io/v1beta2</span>
<span class="na">kind</span><span class="pi">:</span> <span class="s">Kafka</span>
<span class="c1"># ...</span>
<span class="na">spec</span><span class="pi">:</span>
<span class="c1"># ...</span>
  <span class="na">clusterCa</span><span class="pi">:</span>
    <span class="na">generateCertificateAuthority</span><span class="pi">:</span> <span class="kc">false</span>
</code></pre></div></div> <p>Update the certificat secret. The certificat must be the full chain. The old certificat must be renamed with the date and the p12 must be regenerated with the following command:</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>openssl pcs12 <span class="nt">-export</span> <span class="nt">-in</span> wildcard_subdomain_&lt;kafka-cluster&gt;.xxxx.ch_&lt;year&gt;_full.crt <span class="nt">-nokeys</span> <span class="nt">-out</span> ca.p12 <span class="nt">-password</span> pass:&lt;PASSWORD&gt; <span class="nt">-caname</span> ca.crt
</code></pre></div></div> <p>Update the secret <code class="language-plaintext highlighter-rouge">&lt;kafka-cluster&gt;-cluster-ca-cert</code> and increase the annotation <code class="language-plaintext highlighter-rouge">strimzi.io/ca-cert-generation</code>.</p> <div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">kind</span><span class="pi">:</span> <span class="s">Secret</span>
<span class="na">apiVersion</span><span class="pi">:</span> <span class="s">v1</span>
<span class="na">metadata</span><span class="pi">:</span>
  <span class="na">annotations</span><span class="pi">:</span>
    <span class="na">strimzi.io/ca-cert-generation</span><span class="pi">:</span> <span class="s1">'</span><span class="s">2'</span>
  <span class="na">name</span><span class="pi">:</span> <span class="s">&lt;kafka-cluster&gt;</span>
  <span class="na">namespace</span><span class="pi">:</span> <span class="s">amq-streams-kafka</span>
  <span class="na">labels</span><span class="pi">:</span>
    <span class="na">app.kubernetes.io/instance</span><span class="pi">:</span> <span class="s">&lt;kafka-cluster&gt;</span>
    <span class="na">app.kubernetes.io/managed-by</span><span class="pi">:</span> <span class="s">strimzi-cluster-operator</span>
    <span class="na">app.kubernetes.io/name</span><span class="pi">:</span> <span class="s">certificate-authority</span>
    <span class="na">app.kubernetes.io/part-of</span><span class="pi">:</span> <span class="s">strimzi-&lt;kafka-cluster&gt;</span>
    <span class="na">strimzi.io/cluster</span><span class="pi">:</span> <span class="s">&lt;kafka-cluster&gt;</span>
    <span class="na">strimzi.io/component-type</span><span class="pi">:</span> <span class="s">certificate-authority</span>
    <span class="na">strimzi.io/kind</span><span class="pi">:</span> <span class="s">Kafka</span>
    <span class="na">strimzi.io/name</span><span class="pi">:</span> <span class="s">strimzi</span>
<span class="na">data</span><span class="pi">:</span>
  <span class="na">ca.crt</span><span class="pi">:</span> <span class="s">LS0tLS1CRUdJTiBDRVJUSUZJQ0FU...</span>
  <span class="na">ca-2024-09-05T08-15-07Z.crt</span><span class="pi">:</span> <span class="s">LS0tLS1CRUdJTiBDRVJUSUZJQ0...</span>
  <span class="na">ca.p12</span><span class="pi">:</span> <span class="s">MIIRJwIBAzCCEN0GCSqGSIb3DQEHAaCCEM4EghDKMI...</span>
  <span class="na">ca.password</span><span class="pi">:</span> <span class="s">WVRLMFoyVDY2Mzc0</span>
<span class="na">type</span><span class="pi">:</span> <span class="s">Opaque</span>
</code></pre></div></div> <p>Update the secret <code class="language-plaintext highlighter-rouge">&lt;kafka-cluster&gt;-cluster-ca</code> and increase the annotation <code class="language-plaintext highlighter-rouge">strimzi.io/ca-key-generation</code>:</p> <div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">kind</span><span class="pi">:</span> <span class="s">Secret</span>
<span class="na">apiVersion</span><span class="pi">:</span> <span class="s">v1</span>
<span class="na">metadata</span><span class="pi">:</span>
  <span class="na">annotations</span><span class="pi">:</span>
    <span class="na">strimzi.io/ca-key-generation</span><span class="pi">:</span> <span class="s1">'</span><span class="s">2'</span>
  <span class="na">name</span><span class="pi">:</span> <span class="s">&lt;kafka-cluster&gt;-cluster-ca</span>
  <span class="na">namespace</span><span class="pi">:</span> <span class="s">amq-streams-kafka</span>
  <span class="na">labels</span><span class="pi">:</span>
    <span class="na">app.kubernetes.io/instance</span><span class="pi">:</span> <span class="s">&lt;kafka-cluster&gt;</span>
    <span class="na">app.kubernetes.io/managed-by</span><span class="pi">:</span> <span class="s">strimzi-cluster-operator</span>
    <span class="na">app.kubernetes.io/name</span><span class="pi">:</span> <span class="s">certificate-authority</span>
    <span class="na">app.kubernetes.io/part-of</span><span class="pi">:</span> <span class="s">strimzi-&lt;kafka-cluster&gt;</span>
    <span class="na">strimzi.io/cluster</span><span class="pi">:</span> <span class="s">&lt;kafka-cluster&gt;</span>
    <span class="na">strimzi.io/component-type</span><span class="pi">:</span> <span class="s">certificate-authority</span>
    <span class="na">strimzi.io/kind</span><span class="pi">:</span> <span class="s">Kafka</span>
    <span class="na">strimzi.io/name</span><span class="pi">:</span> <span class="s">strimzi</span>
<span class="na">data</span><span class="pi">:</span>
  <span class="na">ca.key</span><span class="pi">:</span> <span class="s">LS0tLS1CRUdJTiBQUklWQVRFIEtFWS0tLS0tCk1JSUV...</span>
<span class="na">type</span><span class="pi">:</span> <span class="s">Opaque</span>
</code></pre></div></div> <p>Enable the reconciliation of Kafka cluster:</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>oc annotate Kafka &lt;kafka-cluster&gt; strimzi.io/pause-reconciliation-
</code></pre></div></div>]]></content><author><name></name></author><category term="kafka"/><category term="kafka"/><summary type="html"><![CDATA[How to change Kafka SSL certificat in OpenShift (AMQ Streams) based on Strimzi]]></summary></entry></feed>